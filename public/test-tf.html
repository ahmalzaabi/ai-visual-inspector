<!DOCTYPE html>
<html>
<head>
    <title>TensorFlow.js Test</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.22.0/dist/tf.min.js"></script>
</head>
<body>
    <h1>TensorFlow.js Model Test</h1>
    <div id="output"></div>
    
    <script>
        async function testModel() {
            const output = document.getElementById('output');
            
            try {
                output.innerHTML += '<p>ğŸ”§ Setting up TensorFlow.js...</p>';
                await tf.ready();
                await tf.setBackend('webgl');
                output.innerHTML += `<p>âœ… Backend: ${tf.getBackend()}</p>`;
                
                output.innerHTML += '<p>ğŸ“¦ Loading model...</p>';
                const model = await tf.loadGraphModel('/models/yolov8_tfjs/model.json');
                output.innerHTML += '<p>âœ… Model loaded!</p>';
                
                output.innerHTML += `<p>ğŸ“Š Inputs: ${JSON.stringify(model.inputs.map(i => i.shape))}</p>`;
                output.innerHTML += `<p>ğŸ“Š Outputs: ${JSON.stringify(model.outputs.map(o => o.shape))}</p>`;
                
                output.innerHTML += '<p>ğŸ”¥ Testing prediction...</p>';
                const testInput = tf.zeros([1, 640, 640, 3]);
                const prediction = await model.predict(testInput);
                
                if (Array.isArray(prediction)) {
                    output.innerHTML += `<p>ğŸ“ Output shapes: ${prediction.map(p => p.shape).join(', ')}</p>`;
                } else {
                    output.innerHTML += `<p>ğŸ“ Output shape: ${prediction.shape}</p>`;
                }
                
                output.innerHTML += '<p>ğŸ‰ Test completed successfully!</p>';
                
                testInput.dispose();
                if (Array.isArray(prediction)) {
                    prediction.forEach(p => p.dispose());
                } else {
                    prediction.dispose();
                }
                
            } catch (error) {
                output.innerHTML += `<p>âŒ Error: ${error.message}</p>`;
                console.error(error);
            }
        }
        
        testModel();
    </script>
</body>
</html> 